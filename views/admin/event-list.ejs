<%- include('../partials/head') %>

<body class="min-h-screen bg-gradient-to-br from-purple-300 via-purple-100 to-purple-300 font-sans">

  <%- include('../partials/nav') %>

  <main class="pt-28 px-4">
    <div class="max-w-6xl mx-auto">

      <!-- Filter Bar -->
      <form method="GET" action="/admin/event-list">
        <div class="mb-6 flex flex-wrap items-center justify-between gap-2 p-3 bg-white/60 backdrop-blur-md rounded-2xl shadow-md">

          <!-- Category Filter -->
          <div class="flex items-center gap-2 flex-1 min-w-[120px]">
            <label class="font-semibold text-purple-900 whitespace-nowrap">Category:</label>
            <select name="category" class="flex-1 border border-purple-900 rounded px-2 py-1 focus:outline-none focus:ring-1 focus:ring-purple-700 shadow-sm">
              <option <%= filterCategory === "All" ? "selected" : "" %>>All</option>
              <option <%= filterCategory === "Workshop" ? "selected" : "" %>>Workshop</option>
              <option <%= filterCategory === "Seminar" ? "selected" : "" %>>Seminar</option>
              <option <%= filterCategory === "Hackathon" ? "selected" : "" %>>Hackathon</option>
              <option <%= filterCategory === "Cultural" ? "selected" : "" %>>Cultural</option>
              <option <%= filterCategory === "Sports" ? "selected" : "" %>>Sports</option>
              <option <%= filterCategory === "Fest" ? "selected" : "" %>>Fest</option>
              <option <%= filterCategory === "Tech" ? "selected" : "" %>>Tech</option>
              <option <%= filterCategory === "Finance" ? "selected" : "" %>>Finance</option>
              <option <%= filterCategory === "Fashion" ? "selected" : "" %>>Fashion</option>
              <option <%= filterCategory === "Mass Media" ? "selected" : "" %>>Mass Media</option>
            </select>
          </div>

          <!-- Status Filter -->
          <div class="flex items-center gap-2 flex-1 min-w-[120px]">
            <label class="font-semibold text-purple-900 whitespace-nowrap">Status:</label>
            <select name="status" class="flex-1 border border-purple-900 rounded px-2 py-1 focus:outline-none focus:ring-1 focus:ring-purple-700 shadow-sm">
              <option <%= filterStatus === "All" ? "selected" : "" %>>All</option>
              <option <%= filterStatus === "Upcoming" ? "selected" : "" %>>Upcoming</option>
              <option <%= filterStatus === "Ongoing" ? "selected" : "" %>>Ongoing</option>
              <option <%= filterStatus === "Past" ? "selected" : "" %>>Past</option>
            </select>
          </div>

          <!-- Apply Button -->
          <div class="flex-shrink-0">
            <button type="submit" class="w-full flex justify-center items-center py-2 px-4 border border-transparent rounded-md shadow-sm
                       text-sm font-medium text-white bg-purple-900 hover:bg-purple-950
                       focus:outline-none focus:ring-1 focus:ring-purple-600 focus:ring-offset-0 transition-transform duration-200 hover:scale-105">
              Apply
            </button>
          </div>

        </div>
      </form>

      <% if(events.length === 0){ %>
        <p class="text-center text-purple-900 font-semibold mt-10">No events match the filter criteria.</p>
      <% } else { %>

        <!-- Table for medium+ screens -->
        <div class="hidden md:block bg-white/80 backdrop-blur-md shadow-lg rounded-3xl p-6 overflow-x-auto">
          <h1 class="text-3xl font-bold mb-6 text-center text-purple-900">Event Lists</h1>
          <table class="min-w-full border border-purple-300 divide-y divide-purple-200">
            <thead class="bg-purple-200/60">
              <tr>
                <th class="px-4 py-2 border-b border-purple-400 text-left text-purple-900 font-semibold">Name</th>
                <th class="px-4 py-2 border-b border-purple-400 text-left text-purple-900 font-semibold">Category</th>
                <th class="px-4 py-2 border-b border-purple-400 text-left text-purple-900 font-semibold">Date</th>
                <th class="px-4 py-2 border-b border-purple-400 text-left text-purple-900 font-semibold">Venue</th>
                <th class="px-4 py-2 border-b border-purple-400 text-left text-purple-900 font-semibold">Organizer</th>
                <th class="px-4 py-2 border-b border-purple-400 text-left text-purple-900 font-semibold">Actions</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-purple-200">
              <% events.forEach((event, index) => { %>
                <tr class="<%= index % 2 === 0 ? 'bg-white/50' : 'bg-white/60' %> hover:bg-purple-100 transition">
                  <td class="px-4 py-2 border-b border-purple-300"><%= event.name %></td>
                  <td class="px-4 py-2 border-b border-purple-300"><%= event.category %></td>
                  <td class="px-4 py-2 border-b border-purple-300"><%= event.startDate.toDateString() %></td>
                  <td class="px-4 py-2 border-b border-purple-300"><%= event.venue %></td>
                  <td class="px-4 py-2 border-b border-purple-300"><%= event.organizer %></td>
                  <td class="px-4 py-2 border-b border-purple-300 space-x-2">
                    <a href="/admin/edit-event/<%= event._id %>" class="bg-amber-400 text-white px-3 py-1 rounded hover:bg-amber-500 transition">Edit</a>
                    <form action="/admin/delete-event/<%= event._id %>" method="POST" class="inline-block">
                      <button type="submit" class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 transition" onclick="return confirm('Are you sure?')">Delete</button>
                    </form>
                  </td>
                </tr>
              <% }) %>
            </tbody>
          </table>
        </div>

        <!-- Cards for small screens -->
        <div class="md:hidden flex flex-col gap-4 mt-6">
          <% events.forEach(event => { %>
            <div class="bg-white/80 backdrop-blur-md shadow-md rounded-2xl p-4 border-l-4 border-purple-500">
              <h2 class="text-xl font-bold text-purple-900 mb-1"><%= event.name %></h2>
              <p class="mb-1">Category: <%= event.category %></p>
              <p class="mb-1">Date: <%= event.startDate.toDateString() %></p>
              <p class="mb-1">Venue: <%= event.venue %></p>
              <p class="mb-2">Organizer: <%= event.organizer %></p>
              <div class="flex gap-2">
                <a href="/admin/edit-event/<%= event._id %>" class="bg-amber-400 text-white px-3 py-1 rounded hover:bg-amber-500 transition">Edit</a>
                <form action="/admin/delete-event/<%= event._id %>" method="POST" class="inline-block">
                  <input type="hidden" name="redirectTo" value="/admin/event-list">
                  <button type="submit" class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 transition" onclick="return confirm('Are you sure?')">Delete</button>
                  
                </form>
              </div>
            </div>
          <% }) %>
        </div>

      <% } %>

    </div>
  </main>
</body>
</html>


