<%- include('../partials/head') %>
<body class="bg-gray-50">

  <%- include('../partials/nav') %>

  <!-- Main Section with Background -->
  <main class="relative flex justify-center items-center min-h-screen px-4 sm:px-6 lg:px-8 pt-28"
        style="background-image: url('/final.jpg'); background-size: cover; background-position: center; background-repeat: no-repeat;">

    <!-- Dark overlay for subtle contrast -->
    <div class="absolute inset-0 bg-black/20 z-0"></div>

    <!-- Registration Card -->
    <div class="relative z-10 w-full max-w-lg bg-white/80 backdrop-blur-md rounded-3xl shadow-2xl p-8 sm:p-10 opacity-0 translate-y-5 transition-all duration-700 ease-out">

      <h2 class="text-3xl font-bold text-purple-900 mb-6 text-center">
        Event Registration
      </h2>

      <!-- Notification Toast -->
      <div id="notification" class="fixed top-5 right-5 z-50">
        <% if (query.status === 'success') { %>
          <div class="bg-green-100 border border-green-300 text-green-800 px-4 py-3 rounded-lg shadow-md animate-fade-in">
            Registration Successful!
          </div>
        <% } else if (query.status === 'already') { %>
          <div class="bg-yellow-100 border border-yellow-300 text-yellow-800 px-4 py-3 rounded-lg shadow-md animate-fade-in">
            You are already registered for this event.
          </div>
        <% } else if (query.status === 'error') { %>
          <div class="bg-red-100 border border-red-300 text-red-800 px-4 py-3 rounded-lg shadow-md animate-fade-in">
            Something went wrong. Please try again.
          </div>
        <% } %>
      </div>

      <form action="/register/<%= event._id %>" method="POST" class="space-y-5">

        <!-- Full Name -->
        <div>
          <label for="studentName" class="block text-gray-700 font-medium mb-1">Full Name</label>
          <input type="text" name="studentName" id="studentName" placeholder="Enter your full name" required
                 class="w-full px-4 py-2 border border-purple-900 rounded-xl shadow-sm placeholder-gray-400
                        focus:outline-none focus:border-purple-950 focus:ring-1 focus:ring-purple-700">
        </div>

        <!-- Email -->
        <div>
          <label for="studentEmail" class="block text-gray-700 font-medium mb-1">Email</label>
          <input type="email" name="studentEmail" id="studentEmail" placeholder="Enter your email" required
                 class="w-full px-4 py-2 border border-purple-900 rounded-xl shadow-sm placeholder-gray-400
                        focus:outline-none focus:border-purple-950 focus:ring-1 focus:ring-purple-700">
        </div>

        <!-- Phone Number -->
        <div>
          <label for="studentPhoneNo" class="block text-gray-700 font-medium mb-1">Phone Number</label>
          <input type="tel" name="studentPhoneNo" id="studentPhoneNo" placeholder="Enter your phone number" required
                 class="w-full px-4 py-2 border border-purple-900 rounded-xl shadow-sm placeholder-gray-400
                        focus:outline-none focus:border-purple-950 focus:ring-1 focus:ring-purple-700">
        </div>

        <!-- Department -->
        <div>
          <label for="studentDepartment" class="block text-gray-700 font-medium mb-1">Department</label>
          <select name="studentDepartment" id="studentDepartment" required
                  class="w-full px-4 py-2 border border-purple-900 rounded-xl shadow-sm placeholder-gray-400
                         focus:outline-none focus:border-purple-950 focus:ring-1 focus:ring-purple-700">
            <option value="" disabled selected>Select your department</option>
            <option value="CSE">CSE</option>
            <option value="BCA">BCA</option>
            <option value="ECE">ECE</option>
            <option value="IT">IT</option>
          </select>
        </div>

        <!-- Submit Button -->
        <div class="text-center">
          <button type="submit"
                  class="w-full flex justify-center items-center py-3 px-4 border border-transparent rounded-md shadow-sm
                       text-sm font-medium text-white bg-purple-900 hover:bg-purple-950
                       focus:outline-none focus:ring-1 focus:ring-purple-600 focus:ring-offset-0 transition-transform duration-200 hover:scale-105">
            Register Now
          </button>
        </div>

      </form>
    </div>
  </main>

  <!-- Smooth Slide-Up Animation -->
  <script>
    const formBox = document.querySelector('.relative.z-10');
    window.addEventListener("DOMContentLoaded", () => {
      requestAnimationFrame(() => {
        formBox.classList.remove("opacity-0", "translate-y-5");
        formBox.classList.add("opacity-100", "translate-y-0");
      });
    });

    const notification = document.getElementById('notification');
    if(notification) {
      setTimeout(() => {
        notification.classList.add('opacity-0', 'transition', 'duration-500', 'ease-out');
        setTimeout(() => notification.remove(), 500);
      }, 3000);
    }
  </script>
</body>
</html>
