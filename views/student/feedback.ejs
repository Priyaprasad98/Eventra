<%- include('../partials/head') %>
</head>
<body class="bg-gray-100">
  <%- include('../partials/nav') %>
  
  <!-- Main Section with Background -->
  <main class="relative flex justify-center items-center min-h-screen px-4 sm:px-6 lg:px-8 pt-28"
        style="background-image: url('/final.jpg'); background-size: cover; background-position: center; background-repeat: no-repeat;"> 

    <!-- Dark overlay for subtle contrast -->
    <div class="absolute inset-0 bg-black/20 z-0"></div>
    
    <!-- Feedback Card -->
    <div class="relative z-10 w-full max-w-lg bg-white backdrop-blur-md rounded-3xl shadow-2xl p-8 sm:p-10 opacity-0 translate-y-5 transition-all duration-700 ease-out">

      <h2 class="text-3xl font-bold text-purple-900 mb-6 text-center">
        Event Feedback
      </h2>


      <form action="/feedback/<%= event._id %>" method="POST" class="space-y-5">
      
       <!-- Full Name -->
        <div>
          <label for="studentName" class="block text-gray-700 font-medium mb-1">Full Name</label>
          <input type="text" name="studentName" id="studentName" placeholder="Enter your full name" required
                 class="w-full px-4 py-2 border border-purple-900 rounded-xl shadow-sm placeholder-gray-400
                        focus:outline-none focus:border-purple-950 focus:ring-1 focus:ring-purple-700">
        </div>

        <!-- Email -->
        <div>
          <label for="studentEmail" class="block text-gray-700 font-medium mb-1">Email</label>
          <input type="email" name="studentEmail" id="studentEmail" placeholder="Enter your email" required
                 class="w-full px-4 py-2 border border-purple-900 rounded-xl shadow-sm placeholder-gray-400
                        focus:outline-none focus:border-purple-950 focus:ring-1 focus:ring-purple-700">
        </div>

        <!-- Rating -->
        <div>
          <label for="rating" class="block text-gray-700 font-medium mb-1">Rating(1-5)</label>
          <select name="rating" id="rating" required
                  class="w-full px-4 py-2 border border-purple-900 rounded-xl shadow-sm placeholder-gray-400
                         focus:outline-none focus:border-purple-950 focus:ring-1 focus:ring-purple-700">
            <option value="" disabled selected>Select rating</option>
            <option value="1">1 - Poor</option>
            <option value="2">2 - Fair</option>
            <option value="3">3 - Good</option>
            <option value="4">4 - Very Good</option>
            <option value="5">5 - Excellent</option>
          </select>
        </div>

        <!-- Feedback Text -->
        <div>
          <label for="feedback" class="block text-gray-700 font-medium mb-2">Your Feedback</label>
          <textarea name="comment" id="comment" rows="5"
                    class="w-full px-4 py-2 border border-purple-900 rounded-xl shadow-sm placeholder-gray-400 focus:outline-none focus:border-purple-950 focus:ring-1 focus:ring-purple-700"
                    placeholder="Write your feedback here..." required></textarea>
        </div>

        <!-- Submit Button -->
        <div class="text-center">
          <button type="submit" 
                  class="bg-purple-600 hover:bg-purple-700 text-white font-semibold px-8 py-3 rounded-lg shadow-lg transition-colors focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2">
            Submit Feedback
          </button>
        </div>
      </form>
      <div id="notification" class="mt-4 w-full relative">
  <% if (query.status === 'already') { %>
    <div class="bg-yellow-100 border-l-4 border-yellow-600 text-yellow-800 px-4 py-3 rounded-lg shadow-md flex items-center space-x-3 opacity-0 translate-y-5 transition-all duration-500 ease-out">
      <svg class="w-5 h-5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v4a1 1 0 102 0V7zm-1 7a1.5 1.5 0 110-3 1.5 1.5 0 010 3z" clip-rule="evenodd"/>
      </svg>
      <span>You are already registered for this event.</span>
    </div>
  <% } else if (query.status === 'NotRegistered') { %>
    <div class="bg-red-100 border-l-4 border-red-600 text-red-800 px-4 py-3 rounded-lg shadow-md flex items-center space-x-3 opacity-0 translate-y-5 transition-all duration-500 ease-out">
      <svg class="w-5 h-5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v4a1 1 0 102 0V7zm-1 7a1.5 1.5 0 110-3 1.5 1.5 0 010 3z" clip-rule="evenodd"/>
      </svg>
      <span>You had not registered to this event.</span>
    </div>
  <% } %>
</div>
    </div>
  </main>
  <!-- Smooth Slide-Up Animation -->
  <script>
        const formBox = document.querySelector('.relative.z-10');
    window.addEventListener("DOMContentLoaded", () => {
      requestAnimationFrame(() => {
        formBox.classList.remove("opacity-0", "translate-y-5");
        formBox.classList.add("opacity-100", "translate-y-0");
      });
    });

        const toast = document.querySelector('#notification > div');
    if(toast) {
      // Slide up and fade in
      requestAnimationFrame(() => {
        toast.classList.remove('opacity-0', 'translate-y-8');
        toast.classList.add('opacity-100', 'translate-y-0');
      });

      // Stay for 3s, then slide down and fade out
      setTimeout(() => {
        toast.classList.remove('opacity-100', 'translate-y-0');
        toast.classList.add('opacity-0', 'translate-y-8');
        setTimeout(() => toast.parentElement.remove(), 500); // Remove from DOM
      }, 5000);
    }
  </script>
</body>
</html>
